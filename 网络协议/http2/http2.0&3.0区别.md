

1. **底层传输协议**
• HTTP/2：基于 TCP（传输控制协议）。  

• HTTP/3：基于 QUIC（Quick UDP Internet Connections），使用 UDP 作为传输层协议。  

  • QUIC 由 Google 设计，整合了 TLS 加密，减少了握手延迟。


---

2. **队头阻塞（Head-of-Line Blocking）**
• HTTP/2：  

  • 虽然通过多路复用（Multiplexing）解决了应用层的队头阻塞（多个请求/响应在一个 TCP 连接上并行传输），但 TCP 层的队头阻塞仍然存在。例如，一个 TCP 包丢失会导致所有流等待重传。  

• HTTP/3：  

  • 在 QUIC 协议层彻底解决了队头阻塞。每个数据流（Stream）独立传输，丢包只影响当前流，其他流不受影响。


---

3. **连接建立和握手延迟**
• HTTP/2：  

  • 需要 TCP 三次握手 + TLS 握手（1-2 RTT）。  

• HTTP/3：  

  • 0-RTT 或 1-RTT 连接：QUIC 将 TLS 加密整合到协议中，首次连接只需 1-RTT，后续连接可复用之前的会话（0-RTT）。  

  • 显著降低延迟，尤其在弱网环境下。


---

4. **连接迁移**
• HTTP/2：  

  • 基于 TCP 的四元组（源IP、源端口、目标IP、目标端口），切换网络（如 Wi-Fi 转 4G）会导致连接中断。  

• HTTP/3：  

  • QUIC 使用 Connection ID 标识连接，允许客户端或服务器在网络变化时无缝迁移连接，无需重新握手。


---

5. **错误恢复和拥塞控制**
• HTTP/3：  

  • QUIC 内置更灵活的拥塞控制机制，且每个流独立控制，避免 TCP 全局拥塞控制的局限性。  

  • 改进的丢包检测和恢复机制（如包编号方式不同）。


---

6. **头部压缩**
• HTTP/2：使用 HPACK 压缩算法，依赖静态和动态表，但需要保证数据包按顺序到达。  

• HTTP/3：改用 QPACK 压缩算法，解决了 HTTP/2 中因数据包乱序导致的动态表同步问题，更适应 QUIC 的传输特性。


---

7. **部署和兼容性**
• HTTP/2：广泛支持，所有现代浏览器和服务器均已实现。  

• HTTP/3：逐步普及中（Chrome、Firefox、Edge 已支持，Nginx、CDN 服务商逐步支持），但可能受限于网络中间设备对 UDP 的屏蔽或 QoS 策略。


---

**总结：HTTP/3 的优势场景**
• 高延迟或高丢包率的网络环境（如移动网络）。  

• 需要频繁切换网络的应用（如移动设备）。  

• 对延迟敏感的服务（如实时通信、在线游戏）。


---

附录：核心差异表
| 特性               | HTTP/2          | HTTP/3          |
|------------------------|---------------------|---------------------|
| 传输层协议             | TCP                 | QUIC（基于 UDP）    |
| 队头阻塞               | TCP 层存在          | 彻底解决            |
| 连接握手延迟           | 1-2 RTT             | 0-1 RTT             |
| 连接迁移支持           | 不支持              | 支持（Connection ID）|
| 加密                   | 可选 TLS            | 强制 TLS 1.3+       |
| 头部压缩算法           | HPACK               | QPACK               |

HTTP/3 通过 QUIC 协议优化了传输效率、安全性和可靠性，是未来 Web 性能提升的重要方向，但在完全普及前可能面临部署挑战。