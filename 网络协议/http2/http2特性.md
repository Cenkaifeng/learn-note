

## HTTP/2 是不是必须基于 TLS/SSL 协议？

* IETF 标准不要求必须基于TLS/SSL协议
* 浏览器要求必须基于TLS/SSL协议
* 在TLS层ALPN(Application Layer Protocol Negotiation)扩展做协商，只认HTTP/1.x的代理服务器不会干扰HTTP/2
* shema: http:// 和 https:// 默认基于80和443端口
* h2: 基于TLS协议运行的HTTP/2 被称为h2
* h2c: 直接在TCP协议之上运行的HTTP/2 被称为h2c


## HTTP/2 核心概念

* 链接Connection: 1个TCP链接，包含一个或多个Stream
* 数据流Stream: 一个双向通讯数据流，包含1条或者多条Message
* 消息 Message: 对应HTTP/1 中的请求或者响应，包含一条或者多条Frame
* 数据帧Frame:最小单位，以二进制压缩格式存放HTTP/1中的内容

>**HTTP/2 主要目的就是盖紧性能，兼容HTTP/1.1**

A1: `HTTP/1.1`中只优化了`body`(`gzip`压缩)并没有对头部进行处理

A2:`HTTP/1.1`问题在于当前请求未得到响应时，不能复用通道再次发送请求。
需要开启**新的TCP连接**发送请求这就是我们所谓的管线化，但是后续的响应要遵循FIFO原则，
如果第一个请求没有返回会被阻塞 **HTTP队头阻塞问题**。（chrome最多并发的请求是6个）

## 特性

1. 多路复用
> 在一条TCP链接上可以乱序收发请求和响应，多个请求和响应之间不再有顺序关系。
  - 同域下采用一个TCP链接传输数据
  - 采用二进制格式，HTTP/1.1采用的是纯文本需要处理空行、大小写等。文本的表现形式有多样性，二进制则只有0和1的组合不再有歧义而且体积更小。把原来的`Header+body`的方式转换为二进制帧。
  - `HTTP/2`虚拟了流的概念（有序帧），给没帧分配一个唯一的流ID,这样数据可以通过ID按顺序组合起来

2. 头部压缩
> 使用 `HPACK`算法压缩HTTP头
  - 废除起始行，全部移入到Header中去，采用**静态表**的方式压缩字段
  - 如果是自定义Header,在发送的过程中会添加到**静态表**后，也就是所谓的**动态表**
  - 对内容进行哈夫曼编码来减小体积

3. 服务端推送
> 服务端可以提前将可能会用到的资源主动推送到客户端